// I ported some of this module, but a few pieces escaped me. - glitch
